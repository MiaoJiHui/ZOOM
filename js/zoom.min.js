(function(a){a.zoom=function(){function h(){b.on("click",function(b){b.preventDefault();if(a(b.target).attr("id")=="zoom")o()});a("#zoom .close").on("click",o);a("#zoom .previous").on("click",l);a("#zoom .next").on("click",m);a(document).keydown(function(a){if(!e)return;if(a.which==27)o();if(a.which==37)l();if(a.which==39)m()});if(a(".gallery li a").length==1)a(".gallery li a")[0].addClass("zoom");a(".zoom, .gallery li a").on("click",k)}function i(){a(window).on("resize",p)}function j(){a(window).on("mousewheel",function(b){if(a("body").hasClass("zoomed"))b.preventDefault()})}function k(f){if(f)f.preventDefault();var g=a(this),h=g.attr("href");if(!h)return;var i=a(new Image).hide();a("#zoom .previous, #zoom .next").show();if(g.hasClass("zoom"))a("#zoom .previous, #zoom .next").hide();if(!d){d=true;b.show();a("body").addClass("zoomed")}c.empty().prepend(i);i.load(n).attr("src",h);e=g}function l(b){if(b)b.preventDefault();if(e.hasClass("zoom"))return;var c=e.parent("li").prev();if(c.length==0)c=a(".gallery li:last-child");c.find("a").trigger("click")}function m(b){if(b)b.preventDefault();if(e.hasClass("zoom"))return;var c=e.parent("li").next();if(c.length==0)c=a(".gallery li:first-child");c.children("a").trigger("click")}function n(){function m(a){a.fadeIn("fast")}var b=a(this),d=parseInt(c.css("borderLeftWidth")),e=f-d*2,h=g-d*2,i=b.width(),j=b.height();if(i==c.width()&&i<=e&&j==c.height()&&j<=h){m(b);return}if(i>e||j>h){var k=h<j?h:j,l=e<i?e:i;if(k/j<=l/i){b.width(i*k/j);b.height(k)}else{b.width(l);b.height(j*l/i)}}c.animate({width:b.width(),height:b.height(),marginTop:-(b.height()/2)-d,marginLeft:-(b.width()/2)-d},200,function(){m(b)})}function o(f){if(f)f.preventDefault();d=false;e=null;b.hide();a("body").removeClass("zoomed");c.empty()}function p(){f=a(window).width();g=a(window).height()}a("body").append('<div id="zoom"><a class="close"></a><a href="#previous" class="previous">Previous</a><a href="#next" class="next">Next</a><div class="content"></div></div>');var b=a("#zoom"),c=a("#zoom .content"),d=false,e=null,f=a(window).width(),g=a(window).height();b.hide();h();i();j()}})(jQuery);